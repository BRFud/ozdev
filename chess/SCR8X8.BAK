WIDTH   equ 29

        psect lowpage

_curcol:
        defb 0
_currow:
        defb 0

global _curcol,_currow,set_a000_400,restore_a000

global _ttyprint
; ttyprint(char c)
_ttyprint:
        ld      a,(_curcol) ; col
        cp      WIDTH
global  _crlf
        call    nc,_crlf

        call    set_a000_400

        push    ix

        ld      hl,4
        add     hl,sp
        ld      l,(hl)          ; print char
        ld      h,0

        add     hl,hl  ; hl=char*2   ;11
        add     hl,hl  ; hl=char*4
        add     hl,hl  ; hl=char*8
        ex      de,hl                ;4
        ld      ix,font              ;14
        add     ix,de                ;15  ;; ix=font+char*8

        ld      hl,_curcol
        ld      c,(hl)
        inc     hl
        ld      a,(hl) ; _currow
        sla     a
	sla	a
	sla	a
	ld	l,a
        ld      h,0       ; hl=8*row
        add     hl,hl     ; hl=2*8*row
        ld      e,l
        ld      d,h       ; de=2*8*row
        add     hl,hl     ; hl=4*8*row
        add     hl,hl     ; hl=8*8*row
        add     hl,hl     ; hl=16*8*row
        add     hl,hl     ; hl=32*8*row
        sbc     hl,de     ; hl=30*8*row
        ld      b,0a0h
        add     hl,bc
        ld      de,30
        ld      b,8

char0:
        ld      a,(ix)
        xor     0
global _reversevideo
_reversevideo equ $-1
        ld      (hl),a
        add     hl,de
        inc     ix
        djnz    char0
cursor:
        ld      hl,_curcol
        inc     (hl)

        pop     ix

        jp      restore_a000


font equ $-20*8

;; character 20

*include pieces.as

defb  0,0,0,0,0,0,0,0  ; 32
defb  24,60,60,24,24,0,24,0  ; 33
defb  54,54,54,0,0,0,0,0  ; 34
defb  54,54,127,54,127,54,54,0  ; 35
defb  24,126,3,62,96,63,24,0  ; 36
defb  0,99,48,24,12,6,99,0  ; 37
defb  28,54,28,110,51,51,110,0  ; 38
defb  24,24,12,0,0,0,0,0  ; 39
defb  24,12,6,6,6,12,24,0  ; 40
defb  6,12,24,24,24,12,6,0  ; 41
defb  0,119,62,127,62,119,0,0  ; 42
defb  0,24,24,126,24,24,0,0  ; 43
defb  0,0,0,0,24,24,12,0  ; 44
defb  0,0,0,127,0,0,0,0  ; 45
defb  0,0,0,0,0,28,28,0  ; 46
defb  96,48,24,12,6,3,1,0  ; 47
defb  62,99,115,123,111,103,62,0  ; 48
defb  24,30,24,24,24,24,126,0  ; 49
defb  62,99,48,24,12,102,127,0  ; 50
defb  62,99,96,60,96,99,62,0  ; 51
defb  48,56,60,54,127,48,48,0  ; 52
defb  127,3,63,96,96,99,62,0  ; 53
defb  62,99,3,63,99,99,62,0  ; 54
defb  127,99,96,48,24,24,24,0  ; 55
defb  62,99,99,62,99,99,62,0  ; 56
defb  62,99,99,126,96,99,62,0  ; 57
defb  0,56,56,0,0,56,56,0  ; 58
defb  0,24,24,0,0,24,24,12  ; 59
defb  48,24,12,6,12,24,48,0  ; 60
defb  0,0,127,0,0,127,0,0  ; 61
defb  6,12,24,48,24,12,6,0  ; 62
defb  62,99,96,48,24,0,24,0  ; 63
defb  62,99,99,123,59,3,126,0  ; 64
defb  28,54,99,99,127,99,99,0  ; 65
defb  63,102,102,62,102,102,63,0  ; 66
defb  60,102,3,3,3,102,60,0  ; 67
defb  31,54,102,102,102,54,31,0  ; 68
defb  127,67,3,31,3,67,127,0  ; 69
defb  127,70,6,62,6,6,15,0  ; 70
defb  62,99,3,3,123,99,62,0  ; 71
defb  99,99,99,127,99,99,99,0  ; 72
defb  60,24,24,24,24,24,60,0  ; 73
defb  60,24,24,24,27,27,14,0  ; 74
defb  99,51,27,15,27,51,99,0  ; 75
defb  15,6,6,6,6,70,127,0  ; 76
defb  99,119,127,107,107,99,99,0  ; 77
defb  99,103,103,111,123,115,99,0  ; 78
defb  62,99,99,99,99,99,62,0  ; 79
defb  63,102,102,62,6,6,15,0  ; 80
defb  62,99,99,99,99,107,62,96  ; 81
defb  63,99,99,63,27,51,99,0  ; 82
defb  62,99,3,62,96,99,62,0  ; 83
defb  126,90,24,24,24,24,60,0  ; 84
defb  99,99,99,99,99,99,62,0  ; 85
defb  99,99,99,99,54,28,8,0  ; 86
defb  99,99,107,107,127,119,99,0  ; 87
defb  99,54,28,28,28,54,99,0  ; 88
defb  102,102,102,60,24,24,60,0  ; 89
defb  127,97,48,24,12,70,127,0  ; 90
defb  62,6,6,6,6,6,62,0  ; 91
defb  3,6,12,24,48,96,64,0  ; 92
defb  62,48,48,48,48,48,62,0  ; 93
defb  8,28,54,99,0,0,0,0  ; 94
defb  0,0,0,0,0,0,0,255  ; 95
defb  12,12,24,0,0,0,0,0  ; 96
defb  0,0,30,48,62,51,126,0  ; 97
defb  7,6,62,102,102,102,63,0  ; 98
defb  0,0,62,99,3,99,62,0  ; 99
defb  56,48,62,51,51,51,126,0  ; 100
defb  0,0,62,99,127,3,62,0  ; 101
defb  56,108,12,63,12,12,30,0  ; 102
defb  0,0,110,115,99,126,96,62  ; 103
defb  7,6,62,102,102,102,103,0  ; 104
defb  24,0,28,24,24,24,60,0  ; 105
defb  48,0,56,48,48,48,51,30  ; 106
defb  7,6,102,54,30,54,103,0  ; 107
defb  24,24,24,24,24,24,56,0  ; 108
defb  0,0,54,127,107,107,99,0  ; 109
defb  0,0,59,102,102,102,102,0  ; 110
defb  0,0,62,99,99,99,62,0  ; 111
defb  0,0,59,102,102,62,6,15  ; 112
defb  0,0,110,51,51,62,48,120  ; 113
defb  0,0,59,102,6,6,15,0  ; 114
defb  0,0,62,3,62,96,62,0  ; 115
defb  12,12,63,12,12,108,56,0  ; 116
defb  0,0,51,51,51,51,110,0  ; 117
defb  0,0,99,99,54,28,8,0  ; 118
defb  0,0,99,99,107,127,54,0  ; 119
defb  0,0,99,54,28,54,99,0  ; 120
defb  0,0,99,99,115,110,96,62  ; 121
defb  0,0,63,25,12,38,63,0  ; 122
;defb  112,24,24,14,24,24,112,0  ; 123
;defb  24,24,24,0,24,24,24,0  ; 124
;defb  14,24,24,112,24,24,14,0  ; 125
;defb  110,59,0,0,0,0,0,0  ; 126
;defb  0,8,28,28,54,54,127,0  ; 127

